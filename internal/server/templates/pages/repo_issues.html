{{define "content"}}
    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
        <h1>Issues: {{.Repo}}</h1>
        <div>
            <button onclick="copyContext()" style="margin-right: 10px;">Copy Context</button>
            <a href="/ui/?repo={{.Repo}}" class="button">Back to Runs</a>
        </div>
    </div>

    {{if .Issues}}
    <div id="issues-context" style="display: none;">
        <issues>
            {{range .Issues}}
            <issue>
                <severity>{{.Severity}}</severity>
                <message>{{.Message}}</message>
                <location>{{.Path}}:{{.Line}}</location>
                <rule>{{.RuleID}}</rule>
                <tool>{{.Tool}}</tool>
            </issue>
            {{end}}
        </issues>
    </div>

    <table>
        <thead>
            <tr>
                <th>Severity</th>
                <th>Message</th>
                <th>Location</th>
                <th>Rule</th>
                <th>Tool</th>
                <th>Run</th>
            </tr>
        </thead>
        <tbody>
            {{range .Issues}}
            <tr>
                <td>
                    <span class="status-badge {{if eq .Severity "error"}}failure{{else if eq .Severity "warning"}}error{{else}}scheduled{{end}}">
                        {{.Severity}}
                    </span>
                </td>
                <td>{{.Message}}</td>
                <td>{{.Path}}:{{.Line}}</td>
                <td>{{.RuleID}}</td>
                <td>{{.Tool}}</td>
                <td>
                    <a href="/ui/run/{{.RunID}}">
                        {{if .CommitMessage}}{{.CommitMessage | subject}}{{else}}Run #{{.RunID}}{{end}}
                    </a>
                </td>
            </tr>
            {{end}}
        </tbody>
    </table>
    {{else}}
    <p>No issues found for this repository.</p>
    {{end}}

    <script>
        function copyContext() {
            const context = document.getElementById('issues-context').innerHTML;
            navigator.clipboard.writeText(context).then(function() {
                alert('Issues context copied to clipboard!');
            }, function(err) {
                console.error('Async: Could not copy text: ', err);
            });
        }
    </script>
{{end}}

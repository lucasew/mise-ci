## 2024-08-01 - Robust Credential Sanitization
**Vulnerability:** The `sanitizeArgs` function in `internal/core/service.go` used a highly specific, case-sensitive check for the username `x-access-token` to redact credentials from URLs. This approach was brittle and could easily fail to prevent the leakage of credentials in logs if different usernames or casing were used.
**Learning:** Relying on specific string checks for credential sanitization is a flawed security practice. A more robust, generalized approach is required to effectively prevent sensitive data exposure. The solution is to parse arguments as URLs and redact any password found in the user information, regardless of the username.
**Prevention:** Implement generalized sanitization routines that do not depend on specific credential formats. Always assume that credentials can appear in unexpected formats and design sanitization logic to be as comprehensive as possible.

## 2026-01-10 - SSRF Vulnerability in Public URL Validation
**Vulnerability:** The `validatePublicURL` function in `cmd/mise-ci/agent.go` was vulnerable to Server-Side Request Forgery (SSRF). It used `http.DefaultClient` to make a request to a URL provided via the `MISE_CI_SERVER_PUBLIC_URL` environment variable. An attacker with control over this variable could force the agent to make requests to internal network services, cloud metadata endpoints, or other sensitive resources.
**Learning:** Configuration values, especially those originating from environment variables, must be treated as untrusted input. The application made an unsafe network request without validating whether the target IP address was on a safe list or, conversely, not on a block list of internal/private IP ranges.
**Prevention:** All external network requests initiated by the application based on user-configurable inputs must be routed through a client that enforces network boundaries. A secure dialer that explicitly blocks connections to private, loopback, and link-local IP addresses should be used to prevent SSRF attacks.

## 2026-01-10 - Incomplete Administrator Credential Validation
**Vulnerability:** The configuration loading mechanism in `internal/config/config.go` did not enforce that administrator credentials must be set together. It was possible to provide an `admin_username` without an `admin_password`, or vice-versa, leading to a partially configured, insecure state where authentication could fail open or be misconfigured.
**Learning:** Security-critical configurations, such as administrator credentials, must be validated atomically. The system should treat a partial configuration as an invalid state and refuse to start, preventing it from running in a potentially insecure mode.
**Prevention:** The configuration loader should be updated to validate that if either `auth.admin_username` or `auth.admin_password` is provided, the other must also be present. This ensures that the administrator account is either fully configured or not configured at all.
